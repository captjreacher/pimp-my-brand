import{j as e}from"./ui-vendor-C0wu6Ixu.js";import{r as i}from"./react-vendor-CaWBk0BP.js";import{u as A,s as n}from"./index-WJiHffTg.js";import{B as q}from"./button-D17X8cRn.js";import{I as m}from"./input-B1s9sH2A.js";import{L as u}from"./label-7zFGR159.js";import{u as F}from"./router-vendor-CjcZkGkV.js";import{L as P}from"./loader-circle-C-FtpdMo.js";import"./supabase-vendor-ChaIFbZk.js";import"./query-vendor-Dx0-x9wB.js";const $=()=>{const[s,v]=i.useState(!1),[l,j]=i.useState(""),[d,y]=i.useState(""),[h,w]=i.useState(""),[p,g]=i.useState(!1),c=F(),{toast:r}=A(),N=async a=>{var f,x,b;a.preventDefault(),g(!0);try{if(s){const{data:t,error:o}=await n.auth.signUp({email:l,password:d,options:{data:{full_name:h},emailRedirectTo:`${window.location.origin}/onboarding`}});if(o)throw o;t.user&&t.session?(r({title:"Welcome!",description:"Let's get you set up..."}),c("/onboarding")):r({title:"Account created!",description:"Please check your email to verify your account."})}else{const{data:t,error:o}=await n.auth.signInWithPassword({email:l,password:d});if(o)throw o;if(t.user){const[S,C,L]=await Promise.all([n.from("brands").select("id").eq("user_id",t.user.id).limit(1),n.from("cvs").select("id").eq("user_id",t.user.id).limit(1),n.from("uploads").select("id").eq("user_id",t.user.id).limit(1)]);(((f=S.data)==null?void 0:f.length)||0)>0||(((x=C.data)==null?void 0:x.length)||0)>0||(((b=L.data)==null?void 0:b.length)||0)>0?(r({title:"Welcome back!",description:"Redirecting to dashboard..."}),c("/dashboard")):(r({title:"Welcome!",description:"Let's get you set up..."}),c("/onboarding"))}}}catch(t){r({variant:"destructive",title:"Error",description:t.message})}finally{g(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-6",children:e.jsx("div",{className:"w-full max-w-md",children:e.jsxs("div",{className:"gradient-card border border-border rounded-3xl p-8 shadow-soft",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"font-heading text-3xl font-bold mb-2",children:s?"Create Account":"Welcome Back"}),e.jsx("p",{className:"text-muted-foreground",children:s?"Sign up to start building your brand":"Sign in to access your dashboard"})]}),e.jsxs("form",{onSubmit:N,className:"space-y-6",children:[s&&e.jsxs("div",{children:[e.jsx(u,{htmlFor:"fullName",children:"Full Name"}),e.jsx(m,{id:"fullName",type:"text",value:h,onChange:a=>w(a.target.value),required:s,className:"mt-2 bg-surface border-border",placeholder:"John Doe"})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"email",children:"Email"}),e.jsx(m,{id:"email",type:"email",value:l,onChange:a=>j(a.target.value),required:!0,className:"mt-2 bg-surface border-border",placeholder:"you@example.com"})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"password",children:"Password"}),e.jsx(m,{id:"password",type:"password",value:d,onChange:a=>y(a.target.value),required:!0,className:"mt-2 bg-surface border-border",placeholder:"••••••••",minLength:6})]}),e.jsx(q,{type:"submit",className:"w-full bg-primary hover:bg-primary/90 font-semibold py-6 rounded-xl",disabled:p,children:p?e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"mr-2 h-4 w-4 animate-spin"}),"Please wait..."]}):s?"Sign Up":"Sign In"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{onClick:()=>v(!s),className:"text-sm text-muted-foreground hover:text-foreground transition",children:s?"Already have an account? Sign in":"Don't have an account? Sign up"})})]})})})};export{$ as default};
