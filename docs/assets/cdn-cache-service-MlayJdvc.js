var fe=Object.defineProperty;var he=(n,e,t)=>e in n?fe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var T=(n,e,t)=>he(n,typeof e!="symbol"?e+"":e,t);import{c as Y,d as me,s as x}from"./index-DuW-Yr95.js";import{n as pe,c as ge,k as Se,j as m,e as k,u as A,i as we,d as z,g as be}from"./ui-vendor-C0wu6Ixu.js";import{r as u}from"./react-vendor-CaWBk0BP.js";import{e as X}from"./select-CGs7PUO_.js";import{u as ve}from"./index-CS5Pkq6r.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=Y("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=Y("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);var G=["PageUp","PageDown"],W=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],J={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},M="Slider",[O,ye,xe]=pe(M),[Q,Ge]=ge(M,[xe]),[_e,B]=Q(M),Z=u.forwardRef((n,e)=>{const{name:t,min:r=0,max:a=100,step:s=1,orientation:o="horizontal",disabled:i=!1,minStepsBetweenThumbs:l=0,defaultValue:d=[r],value:f,onValueChange:c=()=>{},onValueCommit:h=()=>{},inverted:b=!1,form:_,...w}=n,g=u.useRef(new Set),p=u.useRef(0),v=o==="horizontal"?Re:Ce,[S=[],I]=Se({prop:f,defaultProp:d,onChange:y=>{var P;(P=[...g.current][p.current])==null||P.focus(),c(y)}}),K=u.useRef(S);function V(y){const R=Ae(S,y);N(y,R)}function de(y){N(y,p.current)}function ue(){const y=K.current[p.current];S[p.current]!==y&&h(S)}function N(y,R,{commit:P}={commit:!1}){const U=je(s),H=ze(Math.round((y-r)/s)*s+r,U),j=X(H,[r,a]);I((D=[])=>{const C=De(D,j,R);if(Ne(C,l*s)){p.current=C.indexOf(j);const q=String(C)!==String(D);return q&&P&&h(C),q?C:D}else return D})}return m.jsx(_e,{scope:n.__scopeSlider,name:t,disabled:i,min:r,max:a,valueIndexToChangeRef:p,thumbs:g.current,values:S,orientation:o,form:_,children:m.jsx(O.Provider,{scope:n.__scopeSlider,children:m.jsx(O.Slot,{scope:n.__scopeSlider,children:m.jsx(v,{"aria-disabled":i,"data-disabled":i?"":void 0,...w,ref:e,onPointerDown:k(w.onPointerDown,()=>{i||(K.current=S)}),min:r,max:a,inverted:b,onSlideStart:i?void 0:V,onSlideMove:i?void 0:de,onSlideEnd:i?void 0:ue,onHomeKeyDown:()=>!i&&N(r,0,{commit:!0}),onEndKeyDown:()=>!i&&N(a,S.length-1,{commit:!0}),onStepKeyDown:({event:y,direction:R})=>{if(!i){const H=G.includes(y.key)||y.shiftKey&&W.includes(y.key)?10:1,j=p.current,D=S[j],C=s*H*R;N(D+C,j,{commit:!0})}}})})})})});Z.displayName=M;var[ee,te]=Q(M,{startEdge:"left",endEdge:"right",size:"width",direction:1}),Re=u.forwardRef((n,e)=>{const{min:t,max:r,dir:a,inverted:s,onSlideStart:o,onSlideMove:i,onSlideEnd:l,onStepKeyDown:d,...f}=n,[c,h]=u.useState(null),b=A(e,v=>h(v)),_=u.useRef(void 0),w=we(a),g=w==="ltr",p=g&&!s||!g&&s;function E(v){const S=_.current||c.getBoundingClientRect(),I=[0,S.width],V=F(I,p?[t,r]:[r,t]);return _.current=S,V(v-S.left)}return m.jsx(ee,{scope:n.__scopeSlider,startEdge:p?"left":"right",endEdge:p?"right":"left",direction:p?1:-1,size:"width",children:m.jsx(re,{dir:w,"data-orientation":"horizontal",...f,ref:b,style:{...f.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:v=>{const S=E(v.clientX);o==null||o(S)},onSlideMove:v=>{const S=E(v.clientX);i==null||i(S)},onSlideEnd:()=>{_.current=void 0,l==null||l()},onStepKeyDown:v=>{const I=J[p?"from-left":"from-right"].includes(v.key);d==null||d({event:v,direction:I?-1:1})}})})}),Ce=u.forwardRef((n,e)=>{const{min:t,max:r,inverted:a,onSlideStart:s,onSlideMove:o,onSlideEnd:i,onStepKeyDown:l,...d}=n,f=u.useRef(null),c=A(e,f),h=u.useRef(void 0),b=!a;function _(w){const g=h.current||f.current.getBoundingClientRect(),p=[0,g.height],v=F(p,b?[r,t]:[t,r]);return h.current=g,v(w-g.top)}return m.jsx(ee,{scope:n.__scopeSlider,startEdge:b?"bottom":"top",endEdge:b?"top":"bottom",size:"height",direction:b?1:-1,children:m.jsx(re,{"data-orientation":"vertical",...d,ref:c,style:{...d.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:w=>{const g=_(w.clientY);s==null||s(g)},onSlideMove:w=>{const g=_(w.clientY);o==null||o(g)},onSlideEnd:()=>{h.current=void 0,i==null||i()},onStepKeyDown:w=>{const p=J[b?"from-bottom":"from-top"].includes(w.key);l==null||l({event:w,direction:p?-1:1})}})})}),re=u.forwardRef((n,e)=>{const{__scopeSlider:t,onSlideStart:r,onSlideMove:a,onSlideEnd:s,onHomeKeyDown:o,onEndKeyDown:i,onStepKeyDown:l,...d}=n,f=B(M,t);return m.jsx(z.span,{...d,ref:e,onKeyDown:k(n.onKeyDown,c=>{c.key==="Home"?(o(c),c.preventDefault()):c.key==="End"?(i(c),c.preventDefault()):G.concat(W).includes(c.key)&&(l(c),c.preventDefault())}),onPointerDown:k(n.onPointerDown,c=>{const h=c.target;h.setPointerCapture(c.pointerId),c.preventDefault(),f.thumbs.has(h)?h.focus():r(c)}),onPointerMove:k(n.onPointerMove,c=>{c.target.hasPointerCapture(c.pointerId)&&a(c)}),onPointerUp:k(n.onPointerUp,c=>{const h=c.target;h.hasPointerCapture(c.pointerId)&&(h.releasePointerCapture(c.pointerId),s(c))})})}),ne="SliderTrack",oe=u.forwardRef((n,e)=>{const{__scopeSlider:t,...r}=n,a=B(ne,t);return m.jsx(z.span,{"data-disabled":a.disabled?"":void 0,"data-orientation":a.orientation,...r,ref:e})});oe.displayName=ne;var $="SliderRange",ae=u.forwardRef((n,e)=>{const{__scopeSlider:t,...r}=n,a=B($,t),s=te($,t),o=u.useRef(null),i=A(e,o),l=a.values.length,d=a.values.map(h=>ce(h,a.min,a.max)),f=l>1?Math.min(...d):0,c=100-Math.max(...d);return m.jsx(z.span,{"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,...r,ref:i,style:{...n.style,[s.startEdge]:f+"%",[s.endEdge]:c+"%"}})});ae.displayName=$;var L="SliderThumb",se=u.forwardRef((n,e)=>{const t=ye(n.__scopeSlider),[r,a]=u.useState(null),s=A(e,i=>a(i)),o=u.useMemo(()=>r?t().findIndex(i=>i.ref.current===r):-1,[t,r]);return m.jsx(Ee,{...n,ref:s,index:o})}),Ee=u.forwardRef((n,e)=>{const{__scopeSlider:t,index:r,name:a,...s}=n,o=B(L,t),i=te(L,t),[l,d]=u.useState(null),f=A(e,E=>d(E)),c=l?o.form||!!l.closest("form"):!0,h=be(l),b=o.values[r],_=b===void 0?0:ce(b,o.min,o.max),w=ke(r,o.values.length),g=h==null?void 0:h[i.size],p=g?Me(g,_,i.direction):0;return u.useEffect(()=>{if(l)return o.thumbs.add(l),()=>{o.thumbs.delete(l)}},[l,o.thumbs]),m.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[i.startEdge]:`calc(${_}% + ${p}px)`},children:[m.jsx(O.ItemSlot,{scope:n.__scopeSlider,children:m.jsx(z.span,{role:"slider","aria-label":n["aria-label"]||w,"aria-valuemin":o.min,"aria-valuenow":b,"aria-valuemax":o.max,"aria-orientation":o.orientation,"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,tabIndex:o.disabled?void 0:0,...s,ref:f,style:b===void 0?{display:"none"}:n.style,onFocus:k(n.onFocus,()=>{o.valueIndexToChangeRef.current=r})})}),c&&m.jsx(ie,{name:a??(o.name?o.name+(o.values.length>1?"[]":""):void 0),form:o.form,value:b},r)]})});se.displayName=L;var Pe="RadioBubbleInput",ie=u.forwardRef(({__scopeSlider:n,value:e,...t},r)=>{const a=u.useRef(null),s=A(a,r),o=ve(e);return u.useEffect(()=>{const i=a.current;if(!i)return;const l=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(l,"value").set;if(o!==e&&f){const c=new Event("input",{bubbles:!0});f.call(i,e),i.dispatchEvent(c)}},[o,e]),m.jsx(z.input,{style:{display:"none"},...t,ref:s,defaultValue:e})});ie.displayName=Pe;function De(n=[],e,t){const r=[...n];return r[t]=e,r.sort((a,s)=>a-s)}function ce(n,e,t){const s=100/(t-e)*(n-e);return X(s,[0,100])}function ke(n,e){return e>2?`Value ${n+1} of ${e}`:e===2?["Minimum","Maximum"][n]:void 0}function Ae(n,e){if(n.length===1)return 0;const t=n.map(a=>Math.abs(a-e)),r=Math.min(...t);return t.indexOf(r)}function Me(n,e,t){const r=n/2,s=F([0,50],[0,r]);return(r-s(e)*t)*t}function Ie(n){return n.slice(0,-1).map((e,t)=>n[t+1]-e)}function Ne(n,e){if(e>0){const t=Ie(n);return Math.min(...t)>=e}return!0}function F(n,e){return t=>{if(n[0]===n[1]||e[0]===e[1])return e[0];const r=(e[1]-e[0])/(n[1]-n[0]);return e[0]+r*(t-n[0])}}function je(n){return(String(n).split(".")[1]||"").length}function ze(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}var le=Z,Te=oe,Be=ae,Ke=se;const Ve=u.forwardRef(({className:n,...e},t)=>m.jsxs(le,{ref:t,className:me("relative flex w-full touch-none select-none items-center",n),...e,children:[m.jsx(Te,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:m.jsx(Be,{className:"absolute h-full bg-primary"})}),m.jsx(Ke,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));Ve.displayName=le.displayName;class He{constructor(){T(this,"bucketName","ai-generated-assets");T(this,"cdnBaseUrl","https://your-new-project.supabase.co/storage/v1/object/public/");T(this,"defaultTTL",7*24*60*60*1e3)}async cacheAsset(e,t,r,a,s){try{const o=`cached/${e}`,{data:i,error:l}=await x.storage.from(this.bucketName).upload(o,t,{contentType:r,cacheControl:`max-age=${(s||this.defaultTTL)/1e3}`,upsert:!0});if(l)throw l;const d=`${this.cdnBaseUrl}${this.bucketName}/${o}`,f=new Date(Date.now()+(s||this.defaultTTL)).toISOString();return await x.from("ai_cache_entries").upsert({cache_key:e,url:d,content_type:r,size:t.size,expires_at:f,metadata:a||{},hits:0,last_accessed:new Date().toISOString()}),d}catch(o){throw console.error("Failed to cache asset:",o),o}}async getCachedAsset(e){try{const{data:t,error:r}=await x.from("ai_cache_entries").select("*").eq("cache_key",e).single();return r||!t?null:new Date(t.expires_at)<new Date?(await this.invalidateCache(e),null):(await x.from("ai_cache_entries").update({hits:t.hits+1,last_accessed:new Date().toISOString()}).eq("cache_key",e),t.url)}catch(t){return console.error("Failed to get cached asset:",t),null}}async invalidateCache(e){try{const{data:t}=await x.from("ai_cache_entries").select("url").eq("cache_key",e).single();if(t){const r=t.url.replace(`${this.cdnBaseUrl}${this.bucketName}/`,"");await x.storage.from(this.bucketName).remove([r])}await x.from("ai_cache_entries").delete().eq("cache_key",e)}catch(t){console.error("Failed to invalidate cache:",t)}}async cleanupExpiredEntries(){try{const{data:e,error:t}=await x.from("ai_cache_entries").select("cache_key, url").lt("expires_at",new Date().toISOString());if(t||!e)return 0;const r=e.map(s=>s.url.replace(`${this.cdnBaseUrl}${this.bucketName}/`,""));r.length>0&&await x.storage.from(this.bucketName).remove(r);const{error:a}=await x.from("ai_cache_entries").delete().lt("expires_at",new Date().toISOString());if(a)throw a;return e.length}catch(e){return console.error("Failed to cleanup expired entries:",e),0}}async getCacheStats(){try{const{data:e,error:t}=await x.from("ai_cache_entries").select("size, hits");if(t)throw t;const r=(e==null?void 0:e.length)||0,a=(e==null?void 0:e.reduce((d,f)=>d+f.size,0))||0,s=(e==null?void 0:e.reduce((d,f)=>d+f.hits,0))||0,o=r>0?s/r:0,{data:i,error:l}=await x.from("ai_cache_entries").select("cache_key, hits, size").order("hits",{ascending:!1}).limit(10);if(l)throw l;return{totalEntries:r,totalSize:a,hitRate:o,topAssets:(i==null?void 0:i.map(d=>({key:d.cache_key,hits:d.hits,size:d.size})))||[]}}catch(e){return console.error("Failed to get cache stats:",e),{totalEntries:0,totalSize:0,hitRate:0,topAssets:[]}}}generateCacheKey(e,t){const r=Object.keys(t).sort().reduce((o,i)=>(o[i]=t[i],o),{}),a=JSON.stringify(r),s=this.simpleHash(a);return`${e}_${s}`}simpleHash(e){let t=0;for(let r=0;r<e.length;r++){const a=e.charCodeAt(r);t=(t<<5)-t+a,t=t&t}return Math.abs(t).toString(36)}async preloadAssets(e){const t=e.map(async r=>{const a=await this.getCachedAsset(r);if(a)try{await fetch(a,{method:"HEAD"})}catch(s){console.warn(`Failed to preload asset ${r}:`,s)}});await Promise.allSettled(t)}async optimizeCache(){try{const e=await this.getCacheStats(),t=1024*1024*1024;if(e.totalSize>t){const{data:r,error:a}=await x.from("ai_cache_entries").select("cache_key").order("last_accessed",{ascending:!0}).limit(Math.floor(e.totalEntries*.1));if(!a&&r)for(const s of r)await this.invalidateCache(s.cache_key)}await this.cleanupExpiredEntries()}catch(e){console.error("Failed to optimize cache:",e)}}}const We=new He;export{Ye as C,Xe as R,Ve as S,We as c};
