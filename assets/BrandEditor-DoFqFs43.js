import{j as e}from"./ui-vendor-D6k6xAJg.js";import{r as l}from"./react-vendor-CbTYwD9p.js";import{c as le,s as T,a as P,X as B}from"./index-CWAcGGyY.js";import{B as o}from"./button-ro640sRo.js";import{I as g}from"./input-DlTyRBPh.js";import{L as p}from"./label-3xwd5eha.js";import{T as U}from"./textarea-DMLWv3zQ.js";import{C as h,a as m,b as x,c as u}from"./card-CfRzuJdW.js";import{S as G,a as q,b as H,c as O,d as n}from"./select-D-FesbXe.js";import{B as L}from"./badge-DYFFvGV6.js";import{S as ie}from"./separator-C1i2gjVs.js";import{T as oe,a as ce,b,c as w}from"./tabs-D4HRQBSG.js";import{B as de}from"./BrandTemplateRenderer-BmYMQXKl.js";import{a as he,u as me}from"./router-vendor-BssJdvT9.js";import{L as F}from"./loader-circle-Etq7a_Nb.js";import{C as W}from"./chevron-left-BMjbAc_U.js";import{G as X}from"./globe-Cn6vsqJo.js";import{L as J}from"./lock-Cfe6ZteI.js";import{E as xe}from"./eye-DFtfckWq.js";import{S as ue}from"./save-BtpEs3Fh.js";import{F as ge}from"./file-text-DjzqkRut.js";import{P as pe}from"./palette-Cqeja7G2.js";import{S as je}from"./settings-BbPIqtu1.js";import{P as E}from"./plus-htkYI_UT.js";import{S as ve}from"./sparkles-3Bp2-477.js";import"./supabase-vendor-CYMOQS5a.js";import"./query-vendor-CKaEIWod.js";import"./index-2c6_cF8I.js";import"./check-Cp6OSBFl.js";import"./ExecutiveTemplate-B4Hf2As9.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=le("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);function Qe(){const{id:c}=he(),v=me(),[d,Q]=l.useState(null),[Y,A]=l.useState(!0),[I,V]=l.useState(!1),[Z,D]=l.useState("content"),[ee,$]=l.useState(""),[f,z]=l.useState(""),[N,R]=l.useState(""),[y,M]=l.useState(""),se=l.useRef(null),[a,K]=l.useState({title:"",tagline:"",tone_notes:"",bio:"",format_preset:"custom",visibility:"private",strengths:[],weaknesses:[],signature_phrases:[],color_palette:null,fonts:null,logo_url:"",avatar_url:""});l.useEffect(()=>{c&&ae()},[c]),l.useEffect(()=>{if(d){const s={...d,...a};_(s)}},[a.title,a.tagline,a.bio,a.format_preset]);const ae=async()=>{if(c)try{A(!0);const{data:s,error:r}=await T.from("brands").select("*").eq("id",c).single();if(r)throw r;Q(s),K({title:s.title||"",tagline:s.tagline||"",tone_notes:s.tone_notes||"",bio:s.bio||"",format_preset:s.format_preset||"custom",visibility:s.visibility||"private",strengths:s.strengths||[],weaknesses:s.weaknesses||[],signature_phrases:s.signature_phrases||[],color_palette:s.color_palette,fonts:s.fonts,logo_url:s.logo_url||"",avatar_url:s.avatar_url||""}),_(s)}catch(s){console.error("Error fetching brand:",s),P.error("Failed to load brand"),v("/dashboard")}finally{A(!1)}},_=async s=>{var r;try{const{data:t,error:S}=await T.functions.invoke("generate-brand",{body:{extractedText:((r=s.raw_context)==null?void 0:r.extractedText)||"",format:s.format_preset||"custom",userProfile:{name:s.title,bio:s.bio}}});if(S)throw S;$((t==null?void 0:t.markdown)||k(s))}catch(t){console.error("Error generating markdown:",t),$(k(s))}},k=s=>{const r=[];return s.title&&r.push(`# ${s.title}`),s.tagline&&r.push(`*${s.tagline}*`),s.bio&&r.push(`## About

${s.bio}`),s.strengths&&s.strengths.length>0&&r.push(`## Strengths

${s.strengths.map(t=>`- ${t}`).join(`
`)}`),s.signature_phrases&&s.signature_phrases.length>0&&r.push(`## Key Messages

${s.signature_phrases.map(t=>`> "${t}"`).join(`

`)}`),s.tone_notes&&r.push(`## Voice & Tone

${s.tone_notes}`),r.join(`

`)},i=(s,r)=>{K(t=>({...t,[s]:r}))},j=(s,r)=>{if(!r.trim())return;const t=a[s];t.includes(r.trim())||i(s,[...t,r.trim()]),s==="strengths"&&z(""),s==="weaknesses"&&R(""),s==="signature_phrases"&&M("")},C=(s,r)=>{const t=a[s];i(s,t.filter((S,ne)=>ne!==r))},re=async()=>{if(!(!c||!d)){V(!0);try{const{error:s}=await T.from("brands").update({title:a.title,tagline:a.tagline,tone_notes:a.tone_notes,bio:a.bio,format_preset:a.format_preset,visibility:a.visibility,strengths:a.strengths,weaknesses:a.weaknesses,signature_phrases:a.signature_phrases,logo_url:a.logo_url,avatar_url:a.avatar_url,updated_at:new Date().toISOString()}).eq("id",c);if(s)throw s;const r={...d,...a};await _(r),P.success("Brand updated successfully")}catch(s){console.error("Error saving brand:",s),P.error("Failed to save brand")}finally{V(!1)}}},te=()=>{v(`/brand/${c}`)};return Y?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(F,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading brand editor..."})]})}):d?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"sticky top-0 z-50 border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsx("div",{className:"container mx-auto px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(o,{variant:"ghost",onClick:()=>v(`/brand/${c}`),className:"gap-2",children:[e.jsx(W,{className:"h-4 w-4"}),"Back to Brand"]}),e.jsx(ie,{orientation:"vertical",className:"h-6"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Edit Brand"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.title||"Untitled Brand"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:a.visibility==="public"?e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"h-4 w-4"}),"Public"]}):e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"h-4 w-4"}),"Private"]})}),e.jsxs(o,{variant:"outline",onClick:te,children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Preview"]}),e.jsx(o,{onClick:re,disabled:I,children:I?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"h-4 w-4 mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),"Save Changes"]})})]})]})})}),e.jsx("div",{className:"container mx-auto px-6 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 h-[calc(100vh-12rem)]",children:[e.jsx("div",{className:"space-y-6 overflow-y-auto pr-4",children:e.jsxs(oe,{value:Z,onValueChange:D,children:[e.jsxs(ce,{className:"grid w-full grid-cols-4",children:[e.jsxs(b,{value:"content",className:"gap-2",children:[e.jsx(ge,{className:"h-4 w-4"}),"Content"]}),e.jsxs(b,{value:"style",className:"gap-2",children:[e.jsx(pe,{className:"h-4 w-4"}),"Style"]}),e.jsxs(b,{value:"voice",className:"gap-2",children:[e.jsx(fe,{className:"h-4 w-4"}),"Voice"]}),e.jsxs(b,{value:"settings",className:"gap-2",children:[e.jsx(je,{className:"h-4 w-4"}),"Settings"]})]}),e.jsxs(w,{value:"content",className:"space-y-6",children:[e.jsxs(h,{children:[e.jsx(m,{children:e.jsx(x,{children:"Basic Information"})}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"title",children:"Brand Title"}),e.jsx(g,{id:"title",value:a.title,onChange:s=>i("title",s.target.value),placeholder:"Enter your brand title",className:"text-lg"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"tagline",children:"Tagline"}),e.jsx(g,{id:"tagline",value:a.tagline,onChange:s=>i("tagline",s.target.value),placeholder:"A compelling tagline that captures your essence"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"bio",children:"Brand Story"}),e.jsx(U,{id:"bio",value:a.bio,onChange:s=>i("bio",s.target.value),placeholder:"Tell your brand story...",className:"h-32"})]})]})]}),e.jsxs(h,{children:[e.jsx(m,{children:e.jsx(x,{children:"Brand Strengths"})}),e.jsxs(u,{className:"space-y-4",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:a.strengths.map((s,r)=>e.jsxs(L,{variant:"default",className:"gap-1",children:[s,e.jsx(o,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-transparent",onClick:()=>C("strengths",r),children:e.jsx(B,{className:"h-3 w-3"})})]},r))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{value:f,onChange:s=>z(s.target.value),placeholder:"Add a strength",onKeyPress:s=>s.key==="Enter"&&j("strengths",f)}),e.jsx(o,{onClick:()=>j("strengths",f),disabled:!f.trim(),children:e.jsx(E,{className:"h-4 w-4"})})]})]})]}),e.jsxs(h,{children:[e.jsx(m,{children:e.jsx(x,{children:"Areas for Growth"})}),e.jsxs(u,{className:"space-y-4",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:a.weaknesses.map((s,r)=>e.jsxs(L,{variant:"secondary",className:"gap-1",children:[s,e.jsx(o,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-transparent",onClick:()=>C("weaknesses",r),children:e.jsx(B,{className:"h-3 w-3"})})]},r))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{value:N,onChange:s=>R(s.target.value),placeholder:"Add an area for improvement",onKeyPress:s=>s.key==="Enter"&&j("weaknesses",N)}),e.jsx(o,{onClick:()=>j("weaknesses",N),disabled:!N.trim(),children:e.jsx(E,{className:"h-4 w-4"})})]})]})]})]}),e.jsxs(w,{value:"voice",className:"space-y-6",children:[e.jsxs(h,{children:[e.jsx(m,{children:e.jsx(x,{children:"Signature Phrases"})}),e.jsxs(u,{className:"space-y-4",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:a.signature_phrases.map((s,r)=>e.jsxs(L,{variant:"outline",className:"gap-1",children:['"',s,'"',e.jsx(o,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-transparent",onClick:()=>C("signature_phrases",r),children:e.jsx(B,{className:"h-3 w-3"})})]},r))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{value:y,onChange:s=>M(s.target.value),placeholder:"Add a signature phrase",onKeyPress:s=>s.key==="Enter"&&j("signature_phrases",y)}),e.jsx(o,{onClick:()=>j("signature_phrases",y),disabled:!y.trim(),children:e.jsx(E,{className:"h-4 w-4"})})]})]})]}),e.jsxs(h,{children:[e.jsx(m,{children:e.jsx(x,{children:"Tone & Voice Notes"})}),e.jsx(u,{children:e.jsx(U,{value:a.tone_notes,onChange:s=>i("tone_notes",s.target.value),placeholder:"Describe your brand's tone of voice, communication style, and personality...",className:"h-40"})})]})]}),e.jsxs(w,{value:"style",className:"space-y-6",children:[e.jsxs(h,{children:[e.jsx(m,{children:e.jsx(x,{children:"Visual Identity"})}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"logo_url",children:"Logo URL"}),e.jsx(g,{id:"logo_url",value:a.logo_url,onChange:s=>i("logo_url",s.target.value),placeholder:"https://example.com/logo.png"})]}),a.logo_url&&e.jsx("div",{className:"border rounded-lg p-4 bg-muted/50",children:e.jsx("img",{src:a.logo_url,alt:"Brand logo",className:"max-h-24 mx-auto",onError:s=>{s.currentTarget.style.display="none"}})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"avatar_url",children:"Avatar/Profile Image URL"}),e.jsx(g,{id:"avatar_url",value:a.avatar_url||"",onChange:s=>i("avatar_url",s.target.value),placeholder:"https://example.com/avatar.jpg"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Add your profile photo to personalize the template. Leave empty to use template defaults."})]}),a.avatar_url&&e.jsx("div",{className:"border rounded-lg p-4 bg-muted/50",children:e.jsx("img",{src:a.avatar_url,alt:"Profile avatar",className:"max-h-32 mx-auto rounded-lg",onError:s=>{s.currentTarget.style.display="none"}})})]})]}),e.jsxs(h,{children:[e.jsx(m,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-5 w-5"}),"Color Palette & Typography"]})}),e.jsx(u,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Visual styling is automatically generated based on your format preset and content. Advanced customization options coming soon."})})]})]}),e.jsx(w,{value:"settings",className:"space-y-6",children:e.jsxs(h,{children:[e.jsx(m,{children:e.jsx(x,{children:"Presentation Settings"})}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{children:"Format Preset"}),e.jsxs(G,{value:a.format_preset,onValueChange:s=>i("format_preset",s),children:[e.jsx(q,{children:e.jsx(H,{})}),e.jsxs(O,{children:[e.jsx(n,{value:"custom",children:"Custom"}),e.jsx(n,{value:"ufc",children:"UFC Fighter"}),e.jsx(n,{value:"team",children:"Team Captain"}),e.jsx(n,{value:"military",children:"Military"}),e.jsx(n,{value:"nfl",children:"NFL Player"}),e.jsx(n,{value:"influencer",children:"Influencer"}),e.jsx(n,{value:"executive",children:"Executive"}),e.jsx(n,{value:"artist",children:"Artist"}),e.jsx(n,{value:"humanitarian",children:"Humanitarian"}),e.jsx(n,{value:"creator",children:"Content Creator"}),e.jsx(n,{value:"fashion",children:"Fashion"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{children:"Visibility"}),e.jsxs(G,{value:a.visibility,onValueChange:s=>i("visibility",s),children:[e.jsx(q,{children:e.jsx(H,{})}),e.jsxs(O,{children:[e.jsx(n,{value:"private",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-4 w-4"}),"Private - Only you can see this"]})}),e.jsx(n,{value:"public",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4"}),"Public - Anyone with the link can view"]})})]})]})]})]})]})})]})}),e.jsxs("div",{className:"border rounded-lg bg-muted/20 overflow-hidden",children:[e.jsxs("div",{className:"border-b bg-background px-4 py-3",children:[e.jsx("h3",{className:"font-medium",children:"Live Preview"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"See how your brand will look to others"})]}),e.jsx("div",{className:"h-full overflow-y-auto p-6",children:d?e.jsx(de,{ref:se,brand:{...d,...a},markdown:ee||k({...d,...a})}):e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(F,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading brand data..."})]})})})]})]})})]}):e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Brand not found"}),e.jsxs(o,{onClick:()=>v("/dashboard"),children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"Back to Dashboard"]})]})})}export{Qe as default};
